# 変異体探索
- 本書は、_De Novo_ Pjtのために、変異体探索計算のマニュアルをまとめたものである。

## 概要
- タンパク質設計では、制約条件を満たしながら評価値が優れたアミノ酸配列を獲得する計算は必須である。
- ここでは、あるアミノ酸配列から探索を開始し、それを変異させながら探索するが、探索過程では変異数を制限しながら、評価値が優れた変異位置・種類を獲得する。
- また、評価値計算は、Rossetaのcartesian_ddgを使用する。すなわち、変異させたときの⊿⊿Gを最小化する問題を解く。
- pythonコード上で、評価値や制約条件の追加・変更は可能である。

## 計算内容
- xを設計変数、f(x)を評価値とする。すなわち、xは、開始配列からの変異位置と残基種類の組で、f(x)は、開始配列からxに従って変異させたときの⊿⊿Gである。
- また、制約条件は「変異数がM以下」である。ただし、M>0は変異数上限で、ユーザーによって与えられる。
- minimize f(x) subj.to card(x)<=Mを解く。ただし、card(P)は集合Pの要素数である。
    - 任意の制約条件を追加するなら、簡易的にはf(x)にペナルティとして加算する形で考慮できる。
- 探索初期に参照するpdbデータを設定できる。通常はWild-Typeをrelax計算したものを使用する。
- 最適化アルゴリズムは、Local Searchとする。
    - 反復回数kにおける探索点をx(k)とする。
    - 探索点x(k)の近傍を生成する。
    - 近傍の中で目的関数値が最小な解を、探索点の近傍解x_nei(k)とする。f(x(k))とf(x_nei(k))を比べ、改善するなら探索点を近傍解に更新する。
    - 理論的には、探索点は(初期位置に依存する)局所的最適解に収束するが、乱数の影響で⊿⊿Gの値が微小に揺れるため、更新が停滞した後に改善する場合がある。十分な探索回数をかければ、その影響を含めて局所最適な位置に落ち着くと考えられる。
- この計算における近傍は、M以下の変異数の全通りである。
    - 2点変異なら、1点変異の組合せ{(変異位置L, 残基R)}(L×R個)と2点変異の組合せ{(変異位置L1, 残基R1),(変異位置L2, 残基R2)}の全通り。
    - ただし、場合によっては意図的に部分的な変異を除外しても良い。


## 実行手順
- ./work000のフォルダを使う。
- step1: set.iniからパラメータを設定する。
   - 反復回数kmax、探索点数m、試行回数runmaxを設定する。
   - 同じフォルダに開始構造のpdbファイルを入れる。そのファイル名をset.iniに入力する。
- step2: work000.pyを実行する。
- step3: ./output/に結果を示すファイル一式が保存される。


## 出力ファイルの構造
- pdb


